import{a as p}from"./chunk-5HGWMLCT.js";import{a as U,b as C}from"./chunk-JG3PE4XK.js";import{J as h,Ja as l,M as d,N as j,O as w,P as F,Qb as P,R as m,U as c,V as a,W as k,da as D,g as v,ha as E,k as S,s as b,z as y}from"./chunk-HXUONIRB.js";function x(t){t||(E(x),t=k(l));let e=new v(o=>t.onDestroy(o.next.bind(o)));return o=>o.pipe(j(e))}var u=new c("Session id");var I=function(t){return t.AUTH="https://cognito-idp.eu-north-1.amazonaws.com",t.GET_FILMS="https://j5szh4ivo1.execute-api.eu-north-1.amazonaws.com",t.UPDATE_FILM="https://54zfj2agze.execute-api.eu-north-1.amazonaws.com",t}(I||{});var f={baseUrl:"http://localhost:4200",production:!0,clientId:"519h5egol822kv8h9evtpbh051",urlsEnum:I};var A=new c("API token",{factory:()=>f.urlsEnum}),st=new c("API token",{factory:()=>f.baseUrl}),at=new c("Client id",{factory:()=>f.clientId});var M="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",L=()=>{let t=new Date().getTime();return M.replace(/[xy]/g,e=>{let o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e==="x"?o:o&3|8).toString(16)})};var R=t=>t!=null&&t!=="",z=t=>{if(P()){let e=t.getItem("sessionId");return e||(e=L(),t.setItem("sessionId",e)),e}},dt=()=>D([{provide:u,useFactory:z,deps:[p]}]);var g=t=>{let e=new U;return t&&Object.keys(t).forEach(o=>{let r=t[o];R(r)&&(Array.isArray(r)?r.forEach(n=>e=e.append(o,n)):e=e.set(o,t[o]))}),e};var T=(()=>{let e=class e{constructor(r,i){this.apiUrl=r,this.httpClient=i}getFilms(r,i,n){let s=g({id:r,filmCount:i,filmsToExclude:n});return this.httpClient.get(`${this.apiUrl.GET_FILMS}/default/get-films`,{params:s}).pipe(h(1))}updateFilm(r,i,n){let s=g({id:r,film:n,method:i});return this.httpClient.get(`${this.apiUrl.UPDATE_FILM}/default/update-user-films`,{params:s}).pipe(h(1))}};e.\u0275fac=function(i){return new(i||e)(a(A),a(C))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Et=(()=>{let e=class e extends S{get films$(){return this.asObservable()}constructor(r,i,n,s){super([]),this.sessionId=r,this.filmsApiService=i,this.localStorageService=n,this.destroyRef=s}initFilms(){let r=this.localStorageService.getItem("films")||[];this.next(r)}updateFilm(r,i){return this.removeFilm(),this.filmsApiService.updateFilm(this.sessionId,i,r).pipe(F(this),b(([n,s])=>s.map(O=>O.name)),d(n=>this.getFilms(1,n)))}initFilmsListener(){this.pipe(y(r=>!r?.length),d(()=>this.getFilms()),x(this.destroyRef)).subscribe()}removeFilm(){let r=this.value.slice(0,this.value.length-1);this.setFilms(r)}getFilms(r,i){return this.filmsApiService.getFilms(this.sessionId,r,i).pipe(w(n=>{let s=[...n,...this.localStorageService.getItem("films")||[]];this.setFilms(s)}))}setFilms(r){this.next(r),this.localStorageService.setItem("films",r)}};e.\u0275fac=function(i){return new(i||e)(a(u),a(T),a(p),a(l))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{x as a,at as b,dt as c,Et as d};
