import{a as u}from"./chunk-NXDBGRZV.js";import{a as U,b as C}from"./chunk-RJTVMIHQ.js";import{J as d,M as h,Ma as m,N as w,O as j,P as F,R as l,U as c,V as a,Vb as P,W as k,da as D,g as v,ha as E,k as b,s as S,z as y}from"./chunk-G6SFJTCI.js";function x(t){t||(E(x),t=k(m));let e=new v(n=>t.onDestroy(n.next.bind(n)));return n=>n.pipe(w(e))}var p=new c("Session id");var I=function(t){return t.AUTH="https://cognito-idp.eu-north-1.amazonaws.com",t.GET_FILMS="https://j5szh4ivo1.execute-api.eu-north-1.amazonaws.com",t.UPDATE_FILM="https://54zfj2agze.execute-api.eu-north-1.amazonaws.com",t}(I||{});var f={baseUrl:"http://localhost:4200",production:!0,clientId:"519h5egol822kv8h9evtpbh051",urlsEnum:I};var A=new c("API token",{factory:()=>f.urlsEnum}),st=new c("API token",{factory:()=>f.baseUrl}),at=new c("Client id",{factory:()=>f.clientId});var M="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",L=()=>{let t=new Date().getTime();return M.replace(/[xy]/g,e=>{let n=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e==="x"?n:n&3|8).toString(16)})};var O=t=>t!=null&&t!=="",z=t=>{if(P()){let e=t.getItem("sessionId");return e||(e=L(),t.setItem("sessionId",e)),e}},ht=()=>D([{provide:p,useFactory:z,deps:[u]}]);var g=t=>{let e=new U;return t&&Object.keys(t).forEach(n=>{let r=t[n];O(r)&&(Array.isArray(r)?r.forEach(o=>e=e.append(n,o)):e=e.set(n,t[n]))}),e};var R=(()=>{let e=class e{constructor(r,i){this.apiUrl=r,this.httpClient=i}getFilms(r,i,o){let s=g({id:r,filmCount:i,filmsToExclude:o});return this.httpClient.get(`${this.apiUrl.GET_FILMS}/default/get-films`,{params:s}).pipe(d(1))}updateFilm(r,i,o){let s=g({id:r,film:o,method:i});return this.httpClient.get(`${this.apiUrl.UPDATE_FILM}/default/update-user-films`,{params:s}).pipe(d(1))}};e.\u0275fac=function(i){return new(i||e)(a(A),a(C))},e.\u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Et=(()=>{let e=class e extends b{get films$(){return this.asObservable()}constructor(r,i,o,s){super([]),this.sessionId=r,this.filmsApiService=i,this.localStorageService=o,this.destroyRef=s}initFilms(){let r=this.localStorageService.getItem("films")||[];this.next(r)}updateFilm(r,i){return this.removeFilm(),this.filmsApiService.updateFilm(this.sessionId,i,r).pipe(F(this),S(([o,s])=>s.map(T=>T.name)),h(o=>this.getFilms(1,o)))}initFilmsListener(){this.pipe(y(r=>!r?.length),h(()=>this.getFilms()),x(this.destroyRef)).subscribe()}removeFilm(){let r=this.value.slice(0,this.value.length-1);this.setFilms(r)}getFilms(r,i){return this.filmsApiService.getFilms(this.sessionId,r,i).pipe(j(o=>{let s=[...o,...this.localStorageService.getItem("films")||[]];this.setFilms(s)}))}setFilms(r){this.next(r),this.localStorageService.setItem("films",r)}};e.\u0275fac=function(i){return new(i||e)(a(p),a(R),a(u),a(m))},e.\u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ct(t,e,n){let{value:r}=n;if(typeof r!="function")throw new Error(`@bind decorator can only be applied to methods not: ${typeof r}`);return{configurable:!0,get(){let i=r.bind(this);return Object.defineProperty(this,e,{configurable:!0,writable:!0,value:i}),i}}}export{x as a,Ct as b,at as c,ht as d,Et as e};
