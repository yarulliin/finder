import{a as p}from"./chunk-ARLTHZGA.js";import{a as C,b as A}from"./chunk-ZVUSGWEQ.js";import{$b as P,I as h,M as d,N as j,O as w,P as F,Qa as l,S as m,W as c,X as a,Y as k,g as v,ha as D,k as S,la as E,qa as U,s as b,y}from"./chunk-C25PEHV5.js";function x(t){t||(E(x),t=k(l));let e=new v(i=>t.onDestroy(i.next.bind(i)));return i=>i.pipe(j(e))}var u=new c("Session id");var I=function(t){return t.AUTH="https://cognito-idp.eu-north-1.amazonaws.com",t.GET_FILMS="https://j5szh4ivo1.execute-api.eu-north-1.amazonaws.com",t.UPDATE_FILM="https://54zfj2agze.execute-api.eu-north-1.amazonaws.com",t}(I||{});var f={baseUrl:"http://localhost:4200",production:!0,clientId:"519h5egol822kv8h9evtpbh051",urlsEnum:I};var L=new c("API token",{factory:()=>f.urlsEnum}),at=new c("API token",{factory:()=>f.baseUrl}),ct=new c("Client id",{factory:()=>f.clientId});var z="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",R=()=>{let t=new Date().getTime();return z.replace(/[xy]/g,e=>{let i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e==="x"?i:i&3|8).toString(16)})};var T=t=>t!=null&&t!=="",H=(t,e)=>{if(P(e)){let i=t.getItem("sessionId");return i||(i=R(),t.setItem("sessionId",i)),i}},xt=()=>D([{provide:u,useFactory:H,deps:[p,U]}]);var g=t=>{let e=new C;return t&&Object.keys(t).forEach(i=>{let r=t[i];T(r)&&(Array.isArray(r)?r.forEach(n=>e=e.append(i,n)):e=e.set(i,t[i]))}),e};var O=(()=>{let e=class e{constructor(r,o){this.apiUrl=r,this.httpClient=o}getFilms(r,o,n){let s=g({id:r,filmCount:o,filmsToExclude:n});return this.httpClient.get(`${this.apiUrl.GET_FILMS}/default/get-films`,{params:s}).pipe(h(1))}updateFilm(r,o,n){let s=g({id:r,film:n,method:o});return this.httpClient.get(`${this.apiUrl.UPDATE_FILM}/default/update-user-films`,{params:s}).pipe(h(1))}};e.\u0275fac=function(o){return new(o||e)(a(L),a(A))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ut=(()=>{let e=class e extends S{get films$(){return this.asObservable()}constructor(r,o,n,s){super([]),this.sessionId=r,this.filmsApiService=o,this.localStorageService=n,this.destroyRef=s}initFilms(){let r=this.localStorageService.getItem("films")||[];this.next(r)}updateFilm(r,o){return this.removeFilm(),this.filmsApiService.updateFilm(this.sessionId,o,r).pipe(F(this),b(([n,s])=>s.map(M=>M.name)),d(n=>this.getFilms(1,n)))}initFilmsListener(){this.pipe(y(r=>!r?.length),d(()=>this.getFilms()),x(this.destroyRef)).subscribe()}removeFilm(){let r=this.value.slice(0,this.value.length-1);this.setFilms(r)}getFilms(r,o){return this.filmsApiService.getFilms(this.sessionId,r,o).pipe(w(n=>{let s=[...n,...this.localStorageService.getItem("films")||[]];this.setFilms(s)}))}setFilms(r){this.next(r),this.localStorageService.setItem("films",r)}};e.\u0275fac=function(o){return new(o||e)(a(u),a(O),a(p),a(l))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{x as a,I as b,L as c,ct as d,xt as e,Ut as f};
